<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR Multiplayer Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            position: relative;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .player {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: blue;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io(); // Connect to the server
        const players = {};

        // Function to add a new player
        function addPlayer(id, position) {
            const playerElement = document.createElement('div');
            playerElement.className = 'player';
            playerElement.id = id;
            document.body.appendChild(playerElement);
            updatePlayerPosition(id, position);
        }

        // Function to update player position
        function updatePlayerPosition(id, position) {
            const playerElement = document.getElementById(id);
            if (playerElement) {
                playerElement.style.transform = `translate3d(${position.x * 50}px, ${position.y * 50}px, ${position.z * 50}px)`; // Adjust scaling as needed
            }
        }

        // Handle new players
        socket.on('newPlayer', (data) => {
            addPlayer(data.id, data.position);
        });

        // Update current players on connection
        socket.on('currentPlayers', (currentPlayers) => {
            for (let id in currentPlayers) {
                addPlayer(id, currentPlayers[id]);
            }
        });

        // Update player position on movement
        socket.on('move', (data) => {
            updatePlayerPosition(data.id, data.position);
        });

        // Handle player removal
        socket.on('removePlayer', (id) => {
            const playerElement = document.getElementById(id);
            if (playerElement) {
                document.body.removeChild(playerElement);
            }
        });

        // Example movement logic
        document.addEventListener('keydown', (event) => {
            const currentPlayer = players[socket.id] || { x: 0, y: 1.6, z: 0 };
            let newPosition = { ...currentPlayer };

            // Update newPosition based on key pressed (W, A, S, D or arrow keys)
            if (event.key === 'ArrowUp') {
                newPosition.z += 0.1; // Move forward
            } else if (event.key === 'ArrowDown') {
                newPosition.z -= 0.1; // Move backward
            } else if (event.key === 'ArrowLeft') {
                newPosition.x -= 0.1; // Move left
            } else if (event.key === 'ArrowRight') {
                newPosition.x += 0.1; // Move right
            }

            // Emit the new position to the server
            socket.emit('move', { id: socket.id, position: newPosition });
        });
    </script>
</body>
</html>
