<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR Space</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <a-scene>
        <a-entity id="player" geometry="primitive: sphere; radius: 0.5" material="color: blue" position="0 1.6 0"></a-entity>
    </a-scene>

    <script>
        const socket = io();

        socket.on('currentPlayers', (players) => {
            // Logic to add current players to the scene
            for (const id in players) {
                const player = document.createElement('a-entity');
                player.setAttribute('geometry', { primitive: 'sphere', radius: 0.5 });
                player.setAttribute('material', { color: 'blue' });
                player.setAttribute('position', `${players[id].x} ${players[id].y} ${players[id].z}`);
                player.setAttribute('id', id);
                document.querySelector('a-scene').appendChild(player);
            }
        });

        socket.on('newPlayer', (data) => {
            const player = document.createElement('a-entity');
            player.setAttribute('geometry', { primitive: 'sphere', radius: 0.5 });
            player.setAttribute('material', { color: 'blue' });
            player.setAttribute('position', `${data.position.x} ${data.position.y} ${data.position.z}`);
            player.setAttribute('id', data.id);
            document.querySelector('a-scene').appendChild(player);
        });

        socket.on('move', (data) => {
            const player = document.getElementById(data.id);
            if (player) {
                player.setAttribute('position', `${data.position.x} ${data.position.y} ${data.position.z}`);
            }
        });

        socket.on('removePlayer', (id) => {
            const player = document.getElementById(id);
            if (player) {
                player.parentNode.removeChild(player);
            }
        });

        // Simulating movement (for testing, you can implement your own logic)
        document.addEventListener('keydown', (event) => {
            const position = { x: 0, y: 1.6, z: 0 }; // Get current position of the player
            if (event.key === 'ArrowUp') position.z -= 0.1;
            if (event.key === 'ArrowDown') position.z += 0.1;
            if (event.key === 'ArrowLeft') position.x -= 0.1;
            if (event.key === 'ArrowRight') position.x += 0.1;

            // Emit movement to the server
            socket.emit('move', position);
        });
    </script>
</body>
</html>
